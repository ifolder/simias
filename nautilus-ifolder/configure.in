AC_INIT

PACKAGE=nautilus-ifolder
VERSION=0.1.0

AC_SUBST(PACKAGE)
AC_SUBST(VERSION)

AM_INIT_AUTOMAKE($PACKAGE, $VERSION)
AM_CONFIG_HEADER(config.h)

NAUTILUS_MINIMUM_VERSION=2.5.0
EEL_MINIMUM_VERSION=2.5.0
GLIB_MINIMUM_VERSION=2.4.0
GTK_SHARP_MINIMUM_VERSION=1.0.4
GNOME_SHARP_MINIMUM_VERSION=1.0.4
SIMIAS_CLIENT_MINIMUM_VERSION=1.0
IFOLDER_MINIMUM_VERSION=3.0

AC_PROG_CC
AM_PROG_LIBTOOL

GNOME_COMPILE_WARNINGS(maximum)

AC_CHECK_PROG(CSC, mcs, mcs)
test -z "$CSC" && AC_MSG_ERROR([no C Sharp compiler: mcs not found in \$PATH])

dnl Check for pkgconfig first
AC_CHECK_PROG(HAVE_PKGCONFIG, pkg-config, yes, no)

dnl Give error and exit if we don't have pkgconfig
if test "x$HAVE_PKGCONFIG" = "xno"; then
  AC_MSG_ERROR(you need to have pkgconfig installed !)
fi

PKG_CHECK_MODULES(NAUTILUS, libnautilus-extension >= $NAUTILUS_MINIMUM_VERSION eel-2.0 >= $EEL_MINIMUM_VERSION glib-2.0 >= $GLIB_MINIMUM_VERSION)

dnl make GNOME_CFLAGS and GNOME_LIBS available
AC_SUBST(NAUTILUS_CFLAGS)
AC_SUBST(NAUTILUS_LIBS)

PKG_CHECK_MODULES(GTK_SHARP, gtk-sharp >= $GTK_SHARP_MINIMUM_VERSION)
AC_SUBST(GTK_SHARP_LIBS)

PKG_CHECK_MODULES(GNOME_SHARP, gnome-sharp >= $GNOME_SHARP_MINIMUM_VERSION)
AC_SUBST(GNOME_SHARP_LIBS)

PKG_CHECK_MODULES(SIMIAS_CLIENT, simias-client >= $SIMIAS_CLIENT_MINIMUM_VERSION)
AC_SUBST(SIMIAS_CLIENT_LIBS)

PKG_CHECK_MODULES(IFOLDER, ifolder3 >= $IFOLDER_MINIMUM_VERSION)
AC_SUBST(IFOLDER_LIBS)

#
# Configure C# compiler settings
#
CSC_EXEFLAG=/target:exe
CSC_LIBFLAG=/target:library
CSC_WINEXEFLAG=/terget:winexe
CSCFLAGS='/d:MONO /warn:4 /d:TRACE'
CSCFLAGS_DEBUG="/debug+ /d:DEBUG"
CSCFLAGS_OPTIMIZE="/optimize+"
AC_SUBST(CSC)
AC_SUBST(CSC_EXEFLAG)
AC_SUBST(CSC_LIBFLAG)
AC_SUBST(CSC_WINEXEFLAG)
AC_SUBST(CSCFLAGS)

AC_OUTPUT([
  Makefile 
  src/Makefile
])

